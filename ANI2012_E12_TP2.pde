/* ANI-2021 - Programmation en animation
 * Hiver 2022
 * Travail pratique 2
 * Équipe 12 composée de :
   * Alexandre Doucet-Lagueux
   * Christophe Chalifour-Perutin
   * Julie Charbonneau
   * Maïlys Gaudin
   * Olivier Desmarais
 */
 
//Importations de la classe Sound afin de pouvoir jouer des sons
import processing.sound.*;

import java.util.Iterator;

import processing.video.*; // Dépendance: Video 2.0 | GStreamer-based video library for Processing.

//Strcture canevas
final int dimensionX = 1020;
final int dimensionY = 720;

//Nombre de captures d'écran réalisées pendant l'exécution du programme
int idxCapture;

//Références
int centreX, centreY;
boolean pressed;

//Polices de caractère
PFont policeTitre, policeTexte, policeBouton;

//Structure du jeu
boolean debut, jeu; //, fin;
Bouton bCommencer;

//Environnement
PImage imgAccueil;
PImage imgBackground1, imgBackground2, imgBackground3, imgBackground4;
PImage imgPremierPlan;
Movie auroresBoreales;
//final int hauteurCockpit = 242;
//final int dimensionCadreFin = 400;
SoundFile sonClic;

//Fées
PImage[] feeRef;

//Baguette
PImage imgBaguette;
boolean isPSEtoileActive = false;
ParticleSystem psEtoile;
int psEtoileCompte = 500;
SoundFile sonEtoile1, sonEtoile2;
Vector3D pointeBaguette;

//Gestion du temps
float tempsEcoule, tempsCourant;

//Musique
SinOsc musique;
Env enveloppeMusique;
final int[] notesMusique = {440, 494, 554, 494, 440, 494, 554, 494,
                            415, 440, 494, 440, 415, 440, 494, 440,
                            370, 415, 440, 415, 370, 415, 440, 415,
                            415, 440, 494, 440, 415, 440, 494, 440}; 
int idxNote;
float delaiMusique;
float frequenceMusique;
float delaiNote;
final float longueurNote = 0.1f;
boolean musiqueOn;

void settings() {
  size( dimensionX, dimensionY);
}

void setup() {
  
  frameRate(30);
  
  //Références
  idxCapture = 1;
  pressed = false;
  centreX = width / 2;
  centreY = height / 2;
  
  //Structure du jeu
  debut = true;
  jeu = false;
  //fin = false;
  sonClic = new SoundFile(this, "audios/sonClic.wav");
  
  //Polices
  policeTitre  = loadFont("polices/Origicide-48.vlw");
  policeTexte  = loadFont("polices/AvenirLTStd-Book-48.vlw");
  policeBouton = loadFont("polices/AvenirLTStd-Heavy-48.vlw");
  
  //Début du jeu
  bCommencer = new Bouton (centreX, 525, 285, 85, false, "COMMENCER", 22);
  
  //Environnement
  imgAccueil = loadImage("images/ACCEUIL.png");
  imgBackground1 = loadImage("images/LAYER01_BCKGRND.png");
  imgBackground2 = loadImage("images/LAYER02_BCKGRND.png");
  imgBackground3 = loadImage("images/LAYER03_BCKGRND.png");
  imgBackground4 = loadImage("images/LAYER04_BCKGRND.png");
  imgPremierPlan = loadImage("images/FORET_M1.png");
  auroresBoreales = new Movie(this, "video/videoAurore_1.mp4");
  auroresBoreales.loop();

  //Fée
  feeRef = new PImage[3];
  feeRef[0] = loadImage("images/fee/PAPILLON05.png");
  feeRef[1] = loadImage("images/fee/PAPILLON01.png");
  feeRef[2] = loadImage("images/fee/PAPILLON03.png");

  //Baguette
  imgBaguette = loadImage("images/BAGUETTE01.png");
  psEtoile = new ParticleSystem(psEtoileCompte, ParticleSystem.PARTICLE_TYPE_ETOILE);
  sonEtoile1 = new SoundFile(this, "audios/sonEtoileMono.mp3");
  sonEtoile2 = new SoundFile(this, "audios/sonAttaque.mp3");
  pointeBaguette = new Vector3D();
    
  //Musique
  musique = new SinOsc(this);
  enveloppeMusique = new Env(this);
  musique.amp(0.2f);
  idxNote = 0;
  musiqueOn = true;
  frequenceMusique = 0.5f;
}

void draw() {
  //Écran d'accueil
  if (debut) {
    afficherAccueil();
  }
  
  //Déroulement du jeu
  if(jeu) {    
    //Écran principal
    afficherJeu();

    //Gestion du temps
    tempsEcoule = (millis() - tempsCourant) / 1000.0f;
    delaiMusique += tempsEcoule;
    tempsCourant = millis();
      
    //Jouer la musique
    //La vitesse de la musique est directement proportionnelle avec le nombre
    //d'ennemis dans la collection d'ennemis
    //frequenceMusique = map(listeEnnemis.size(), 0, objectifDefaite, 0.2f, 0.1f);
    if (delaiMusique > frequenceMusique) {
      //Option pour inactiver le son (Touche 'm')
      if (musiqueOn)
        jouerMusique();
      delaiMusique -= frequenceMusique;
    }
  }
  /*//Écran de fin
  if (fin) {
    afficherFin();
  }*/
}

void mousePressed() {
  //À quelques endroits dans le programme, il est vérifié si la souris est pressée.
  //Cette variable est notée dans le boolean "pressed".
  pressed = true;
}

void mouseReleased() {
  //Pendant le jeu :
  //Il est vérifié si le relâchement de la souris est une tentative d'attaque.
  //Si oui et le niveau de magie le permet, l'attaque a bien lieu. Sinon, une
  //rétroaction informe le joueur du manque de magie par un son et le cadre de
  //la jauge de magie qui change au rouge.
  if (jeu){

  }
  
  //Pendant le début :
  //Il est vérifié si le relâchement de la souris démontre le désir de cliquer
  //sur le bouton commencer.
  if (debut) {
    if (bCommencer.verifierSuperposition()) {
      clicBouton();
    }
  }

  //Pendant la fin :
  //Il est vérifié si le relâchement de la souris démontre le désir de cliquer
  //sur le bouton rejouer.
  /*if (fin) {
    if (bRejouer.verifierSuperposition()) {
      clicBouton();
    }
  }*/
  
  //La souris n'est plus pressée
  pressed = false;
}

void keyReleased() {
  //Raccourci pour le slider jour-nuit (ESPACE)
  if (key == ' ') {
    
  }
  
  //Raccourci pour cliquer sur un bouton (ENTER)
  if (keyCode == ENTER) {
    clicBouton();
  }
  
  //Touche pour activer/inactiver la musique ('m')
  if (key == 'm')
    musiqueOn = !musiqueOn;
  
  //Touche pour réaliser une capture d'écran ('p')
  if (key == 'p') {
    save("captures/capture" + nf(idxCapture, 2) + ".png");
    idxCapture++;
  }
}

//Fonction appelée au début de chaque partie pour initialiser toutes les valeurs
//à leur état initial
void initialisation() {
  //Gestion du temps
  tempsEcoule = 0.0f;
  tempsCourant = 0.0f;
  tempsCourant = millis();
  
  //Musique
  idxNote = 0;
  jouerMusique();  
}

void afficherAccueil() {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  //Background de l'écran d'accueil
  imageMode(CORNER);
  image(imgAccueil, 0, 0);

  //Affichage du titre
  textAlign(CENTER, CENTER);
  fill(255, 255, 0);
  textFont(policeTitre, 120);
  text("STARCATCH", centreX, 200);
  
  //Affichage des instructions
  fill(255);
  textFont(policeTexte, 18);
  String[] lignesTexte = new String[5];
  lignesTexte[0] = "Tentez de vaincre les envahisseurs en cliquant sur eux";
  lignesTexte[1] = "avant qu'ils soient trop nombeux ! Afin d'avoir assez";
  lignesTexte[2] = "de magie pour attaquer, alternez entre le jour et la nuit et";
  lignesTexte[3] = "attrapez des étoiles. Il faut cependant faire vite, car ces";
  lignesTexte[4] = "extra-terresetres se multiplient à la vitesse de la lumières !";
  //Emplacement de chacune des lignes
  float posY = 325;  
  int hauteurLigne = 20;
  //Affichage de chacune des lignes
  for (int ligne = 0 ; ligne < lignesTexte.length ; ligne++) {
    text(lignesTexte[ligne], centreX, posY);
    posY += hauteurLigne;
  }
  
  //Afficage du bouton pour commencer
  bCommencer.render();
}

void afficherJeu() {
  //Afficher le décor
  imageMode(CORNER);
  auroresBoreales.play();
  image(auroresBoreales, 0, -200);
  tint(255, 200);
  image(imgBackground4, 0, 0);
  tint(255, 255);
  image(imgBackground3, 0, 0);
  image(imgBackground2, 0, 0);
  image(imgBackground1, 0, 0);
  image(imgPremierPlan, 0, 0);
  
  
  
  
  afficherBaguette();
}

void movieEvent(Movie movie)
{
  movie.read();
}

/*void afficherFin() {
  //L'arrière-plan de l'écran de fin est affiché dans la fonction transitionFin().
  //Il s'agit d'une copie du caneva au moment où le jeu prend fin. Cette image est
  //ensuite floutée puis affichée.
  
  //Afficher le cadre de fond
  rectMode(CENTER);
  stroke(4,51,83,255);
  strokeWeight(10);
  fill(255);
  rect(centreX, centreY, dimensionCadreFin, dimensionCadreFin);
  
  //Afficher le texte
  textAlign(CENTER, CENTER);
  fill(0);
  
  //Affichage du bouton pour rejouer
  //bRejouer.render();
}*/

//Fonction permettant la synthétisation de la musique ambiante pendant le jeu.
void jouerMusique() {
  //Jouer la musique
  musique.freq(notesMusique[idxNote]);
  musique.play();
  enveloppeMusique.play(musique, 0.01f, 0.004f, 0.3f, 0.4f);
  
  //Index de la prochaine note
  if (idxNote < notesMusique.length - 1)
    idxNote++;
  else
    idxNote = 0;
}

//Fonction appelée lorsque le bouton "commencer" est appuyé
void clicBouton() {
  //Initialisation de la partie
  initialisation();
  
  //Transition du début/de la fin du jeu vers le jeu
  jeu = true;
  debut = false;
  //fin = false;
  
  //Son du bouton
  sonClic.play();
}

void afficherBaguette() {
  
  //Identifier l'emplacement de la pointe de la baguette
  pointeBaguette.set(mouseX - imgBaguette.width + 80, mouseY - imgBaguette.height + 70, 0.0f);
  
  //Update et affichage d'un système de particules en forme d'étoile à la pointe de la baguette. 
  //De nouvelles particules ne sont créées que lorsque la souris est enfoncée.
  psEtoile.update(pressed);
  
  /*//Affichage d'un cerle autour de la baguette lorsque la souris est pressée
  fill(255, 155);
  noStroke();
  ellipseMode(CENTER);
  if(pressed)
    ellipse(pointeBaguette.x, pointeBaguette.y, 20, 20);*/
  
  //Afficher la baguette à l'endroit approprié
  imageMode(CORNER);
  image(imgBaguette, mouseX - imgBaguette.width + 45, mouseY - imgBaguette.height + 40);
  

}
